{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-6 text-orange-600">Tin Nhắn Của Bạn</h1>

    <div class="bg-white shadow-md rounded-lg overflow-hidden">
        <ul class="divide-y divide-gray-200">
            {% for item in conversations %}
            <li>
                <a href="{{ url_for('messages_chat.chat', recipient_id=item.user.id) }}"
                    class="block hover:bg-gray-50 transition duration-150 ease-in-out">
                    <div class="px-6 py-4 flex items-center">
                        <div class="flex-shrink-0">
                            <!-- Placeholder Avatar -->
                            <div
                                class="h-12 w-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-600 font-bold text-xl">
                                {{ item.user.username[0].upper() }}
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <div class="flex items-center justify-between">
                                <p class="text-sm font-medium text-blue-600 truncate">
                                    {{ item.user.username }}
                                </p>
                                <div class="ml-2 flex-shrink-0 flex">
                                    <p
                                        class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                        {{ item.last_message.timestamp.strftime('%d/%m %H:%M') }}
                                    </p>
                                </div>
                            </div>
                            <div class="mt-2 flex justify-between">
                                <p class="text-sm text-gray-500 truncate">
                                    {% if item.last_message.sender_id == current_user.id %}
                                    <span class="text-gray-400">Bạn:</span>
                                    {% endif %}
                                    {{ item.last_message.body }}
                                </p>
                            </div>
                        </div>
                    </div>
                </a>
            </li>
            {% else %}
            <li class="px-6 py-8 text-center text-gray-500">
                Bạn chưa có tin nhắn nào. <br>
                <a href="{{ url_for('posts_view.index') }}" class="text-orange-600 hover:underline">Tìm đồ và liên hệ
                    người đăng
                    tin ngay!</a>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}